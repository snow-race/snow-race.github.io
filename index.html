<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"><meta name="theme-color" content="#ffffff"><link rel='manifest' href='/manifest.json'><link rel="apple-touch-icon" href="/icon-512x512.png"><title>Приложение старт-финиш</title><link rel="stylesheet" href="materialize.min.css"><link href="icon.css" rel="stylesheet"> <script type="module" src="https://cdn.jsdelivr.net/npm/@pwabuilder/pwainstall@latest/dist/pwa-install.min.js"></script> <style>html{-ms-touch-action:manipulation;touch-action:manipulation}</style></head><body><div id="app"> <nav><div class="nav-wrapper" v-show="trrt === 'main'"><ul class="left hide-on-small-only"><li><pwa-install>Установить</pwa-install></li><li><a href="" @click.prevent="trrt = 'add'">добавить спортсмена</a></li><li><a href="" @click.prevent="yuyimiu(); trrt = 'rez'">результаты</a></li><li><a href="" @click.prevent="trrt = 'settings'">настройки</a></li></ul><ul class="right show-on-small" style="trrt:none;"><li><pwa-install>Установить</pwa-install></li><li><a href="" @click.prevent="trrt = 'add'"><i class="material-icons">add</i></a></li><li><a href="" @click.prevent="yuyimiu(); trrt = 'rez'"><i class="material-icons">insert_chart</i></a></li><li><a href="" @click.prevent="trrt = 'settings'"><i class="material-icons">settings</i></a></li></ul></div><div class="nav-wrapper" v-show="trrt !== 'main'"><ul><li class="left hide-on-small-only"><a href="" @click.prevent="trrt = 'main'">назад</a></li><li class="right show-on-small" style="trrt:none;"><a href="" @click.prevent="trrt = 'main'; sdwsrfg()"><i class="material-icons">arrow_back</i></a></li></ul></div> </nav><div v-if="trrt === 'main'"><div class="row"><div class="col s12 center"><h1>{{jtuj6jujShow}}</h1></div></div><div class="row center" v-if="!tujyjmyu.length && rtrtyry.length"><a class="waves-effect waves-light btn center" @click.prevent="ykikui()"><i class="material-icons left">replay</i>Сбросить результаты</a></div><div class="row"><div class="col s12" v-if="tujyjmyuIndexes.length"><ul class="collection with-header"><li class="collection-item" style="font-size: 150%; padding-left: 10px; padding-right: 10px;"><div> №{{rtrtyry[currentUserId].num}}: {{rtrtyryTimeShow[currentUserId].name}} <a href="" class="secondary-content" @click.prevent="jyjgjy(rtrtyry[currentUserId].id)"><i class="material-icons red-text">delete_forever</i></a> <span v-show="rtrtyry[currentUserId].htytjjy > 0" class="right">{{rtrtyryTimeShow[currentUserId].htytjjy}}</span><span v-show="rtrtyry[currentUserId].htytjjy === -1" class="right"><i class="material-icons">highlight_off</i></span></div></li><li class="collection-item grey-text text-darken-2" style="font-size: 150%; padding-left: 10px; padding-right: 10px;" v-for="id in tujyjmyuIndexes" :key="id" v-show="id !== currentUserId"><div> №{{rtrtyry[id].num}}: {{rtrtyryTimeShow[id].name}} <a href="" class="secondary-content" @click.prevent="jyjgjy(rtrtyry[id].id)"><i class="material-icons red-text">delete_forever</i></a> <span v-show="rtrtyry[id].htytjjy > 0" class="right">{{rtrtyryTimeShow[id].htytjjy}}</span><span v-show="rtrtyry[id].htytjjy === -1" class="right"><i class="material-icons">highlight_off</i></span></div></li></ul></div></div></div> <nav v-if="trrt === 'main'" style="position:fixed;bottom:0;left:0;width:100%;"><div class="nav-wrapper"><div class="right hide-on-small-only"><ul class="right" v-if="jtuj6juj === 0"><li><a class="waves-effect waves-light btn" href="" @click.prevent="hdg()">старт</a></li><li><a class="waves-effect waves-light btn" href="" @click.prevent="rtukkuyk()">пропустить</a></li><li><a class="waves-effect waves-light btn" href="" @click.prevent="disq()">дисквалификация</a></li></ul><ul class="right" v-else><li><a class="waves-effect waves-light btn" href="" @click.prevent="hfjgj()">финиш</a></li><li><a class="waves-effect waves-light btn" href="" @click.prevent="rtukkuyk()">перестартовать</a></li><li><a class="waves-effect waves-light btn" href="" @click.prevent="disq()">сход</a></li></ul></div><div class="right show-on-small" style="trrt:none;"><ul class="right" v-if="jtuj6juj === 0"><li><a href="" @click.prevent="disq()"><i class="material-icons">highlight_off</i></a></li><li><a href="" @click.prevent="rtukkuyk()"><i class="material-icons">hourglass_empty</i></a></li><li><a href="" @click.prevent="hdg()"><i class="material-icons">play_arrow</i></a></li></ul><ul class="right" v-else><li><a href="" @click.prevent="disq()"><i class="material-icons">highlight_off</i></a></li><li><a href="" @click.prevent="rtukkuyk()"><i class="material-icons">replay</i></a></li><li><a href="" @click.prevent="hfjgj()"><i class="material-icons">check</i></a></li></ul></div></div> </nav><div id="rez" v-if="(trrt === 'rez')"><div class="row"><div class="col s12" v-if="this.rtrtyry.length"><ul class="collection with-header show-on-small" style="trrt:none;"><li class="collection-item grey-text text-darken-2" style="font-size: 150%; padding-left: 10px; padding-right: 10px;" v-for="id in rtjjtj" :key="id"><div><div class="row" style="margin-bottom: 0px; margin-left: auto; margin-right: auto;"><div class="row" style="margin-bottom: 5px; margin-left: auto; margin-right: auto;">№{{rtrtyry[id].num}}: {{rtrtyry[id].name}}</div><div class="row center" style="margin-bottom: 0px; margin-left: auto; margin-right: auto;"> <span v-show="rtrtyry[id].htytjjy > 0">{{rtrtyryTimeShow[id].htytjjy}}</span> <span v-show="rtrtyry[id].htytjjy === -1"><i class="material-icons">highlight_off</i></span> <span v-show="rtrtyry[id].yujtj > 0">&nbsp;&nbsp;{{rtrtyryTimeShow[id].yujtj}}</span> <span v-show="rtrtyry[id].yujtj === -1">&nbsp;&nbsp;<i class="material-icons">highlight_off</i></span> <span v-show="rtrtyryTimeShow[id].timeR !== 'D' && rtrtyryTimeShow[id].timeR != 0 " class="red-text">&nbsp;&nbsp;{{rtrtyryTimeShow[id].timeR}}</span> <span v-show="rtrtyryTimeShow[id].timeR === 'D' " class="red-text">&nbsp;&nbsp;<i class="material-icons">highlight_off</i></span></div></div></div></li></ul><ul class="collection with-header hide-on-small-only"><li class="collection-item grey-text text-darken-2" style="font-size: 150%; padding-left: 10px; padding-right: 10px;" v-for="id in rtjjtj" :key="id"><div> №{{rtrtyry[id].num}}: {{rtrtyry[id].name}} <span class="right"> <span v-show="rtrtyry[id].htytjjy > 0">{{rtrtyryTimeShow[id].htytjjy}}</span> <span v-show="rtrtyry[id].htytjjy === -1"><i class="material-icons">highlight_off</i></span> <span v-show="rtrtyry[id].yujtj > 0">&nbsp;&nbsp;{{rtrtyryTimeShow[id].yujtj}}</span> <span v-show="rtrtyry[id].yujtj === -1">&nbsp;&nbsp;<i class="material-icons">highlight_off</i></span> <span v-show="rtrtyryTimeShow[id].timeR !== 'D' && rtrtyryTimeShow[id].timeR != 0" class="red-text">&nbsp;&nbsp;{{rtrtyryTimeShow[id].timeR}}</span> <span v-show="rtrtyryTimeShow[id].timeR === 'D' " class="red-text">&nbsp;&nbsp;<i class="material-icons">highlight_off</i></span> </span></div></li></ul></div></div></div><div id="settings" v-show="trrt === 'settings'" style="margin: 10px;"><div class="row"><div class="input-field col s12"> <select v-model="hdhhh"><option value="1" selected>1</option><option value="2" >2</option> </select> <label>Количество этапов</label></div></div><div class="row"><div class="input-field col s12" v-show="hdhhh == 2"> <select v-model="wrtye"><option value="sum" selected>Cумма</option><option value="avg">Cреднее</option> </select> <label>Итоговое время</label></div></div><div class="row"><div class="input-field col s12 center"> <a class="waves-effect waves-light btn" @click.prevent="ykikui()"><i class="material-icons left">replay</i>Сбросить результаты</a></div></div><div class="row"><div class="input-field col s12 center"> <a class="waves-effect waves-light btn red" @click.prevent="resetAll()"><i class="material-icons left">replay</i>Сброс всех настроек</a></div></div></div><div id="add-user" v-if="trrt === 'add'" style="margin: 10px;"><div class="input-field col s12"> <input id="num" type="text" class="validate" v-model="rtyjtrj.num"> <label for="num">№ майки</label></div><div class="input-field col s12"> <input id="name" type="text" class="validate" v-model="rtyjtrj.name"> <label for="name">Имя</label></div><div class="col s12"> <a class="waves-effect waves-light btn left" @click="gfhh()">Добавить</a> <a class="waves-effect waves-light btn right" @click="trrt = 'main'">Отмена</a></div></div><div id="delete-user-modal1" class="modal bottom-sheet"><div class="modal-content"><h4>Удалить спортсмена?</h4></div><div class="modal-footer"> <a class="modal-close waves-effect waves-green btn-flat" @click.prevent="gyjyuky()" style="cursor: pointer;">Удалить</a> <a class="modal-close waves-effect waves-green btn-flat" style="cursor: pointer;">Отмена</a></div></div><div id="info" v-if="yiubg"> стартует {{currentUserId}}<br><div id="all"><h4>все спортсмены</h4><div class="user" v-for="user of rtrtyry" :key="user.id" style="margin: 10px;"> {{user.num}} {{user.name}} {{user.htytjjy}} {{user.yujtj}} {{user.round}}</div></div><br></div></div> <script src="jquery-3.5.1.min.js"></script> <script src="materialize.min.js"></script> <script src="vue.global.js"></script> <script type="module">import'https://cdn.jsdelivr.net/npm/@pwabuilder/pwaupdate';const el=document.createElement('pwa-update');document.body.appendChild(el);</script> <script>$(document).ready(function(){$("select").formSelect(),$(".modal").modal()});const App={data:()=>({jtuj6juj:0,lastTimeShow:0,rtrtyry:[{id:1,num:"1",name:"\u0418\u0432\u0430\u043D\u043E\u0432 \u0418.\u0418.",htytjjy:0,yujtj:0,dis:!1,round:1},{id:2,num:"2",name:"\u041F\u0435\u0442\u0440\u043E\u0432 \u041F.\u041F.",htytjjy:0,yujtj:0,dis:!1,round:1},{id:3,num:"3",name:"\u0421\u0438\u0434\u043E\u0440\u043E\u0432 \u0421.\u0421.",htytjjy:0,yujtj:0,dis:!1,round:1}],tujyjmyu:[1,2,3],rtjjtj:[],rtyjtrj:{id:null,name:"",num:"",htytjjy:0,yujtj:0,dis:!1,round:1},userToDeleteId:null,hdhhh:1,wrtye:"sum",trrt:"main",fghfyh:null,trrtWidth:null,yiubg:!1,fjfyjyjy:{Digit0:!1,Digit1:!1,Digit8:!1}}),computed:{currentUserId(){return this.rtrtyry.findIndex(a=>a.id===this.tujyjmyu[0])},tujyjmyuIndexes(){let a=[];for(let b=0;b<this.tujyjmyu.length;b++)a.push(this.rtrtyry.findIndex(a=>a.id===this.tujyjmyu[b]));return a},jtuj6jujShow(){let a="";return 0===this.jtuj6juj?this.lastTimeShow:(a=60>this.jtuj6juj?this.jtuj6juj.toFixed(3):Math.floor(this.jtuj6juj/60)+"."+(this.jtuj6juj-60*Math.floor(this.jtuj6juj/60)).toFixed(3),this.lastTimeShow=a,a)},rtrtyryTimeShow(){let a=[],b=Math.floor(13+(this.trrtWidth-360)/11);for(let c,d=0;d<this.rtrtyry.length;d++){if(c={name:this.rtrtyry[d].name,htytjjy:0,yujtj:0,timeR:0},c.name.length>b&&(c.name=c.name.substring(0,b-3)+"..."),-1===this.rtrtyry[d].htytjjy&&(c.htytjjy="D"),0<this.rtrtyry[d].htytjjy&&(60<this.rtrtyry[d].htytjjy?c.htytjjy=Math.floor(this.rtrtyry[d].htytjjy/60)+"."+(this.rtrtyry[d].htytjjy-60*Math.floor(this.rtrtyry[d].htytjjy/60)).toFixed(3):c.htytjjy=this.rtrtyry[d].htytjjy.toFixed(3)),-1===this.rtrtyry[d].yujtj&&(c.yujtj="D"),0<this.rtrtyry[d].yujtj&&(60<this.rtrtyry[d].yujtj?c.yujtj=Math.floor(this.rtrtyry[d].yujtj/60)+"."+(this.rtrtyry[d].yujtj-60*Math.floor(this.rtrtyry[d].yujtj/60)).toFixed(3):c.yujtj=this.rtrtyry[d].yujtj.toFixed(3)),-1===this.rtrtyry[d].htytjjy||-1===this.rtrtyry[d].yujtj)c.timeR="D";else if(1===this.rtrtyry[d].round)c.timeR=c.htytjjy;else{let a=0;a="sum"===this.wrtye?this.rtrtyry[d].htytjjy+this.rtrtyry[d].yujtj:(this.rtrtyry[d].htytjjy+this.rtrtyry[d].yujtj)/2,c.timeR=60<a?Math.floor(a/60)+"."+(a-60*Math.floor(a/60)).toFixed(3):a.toFixed(3)}a.push(c)}return a}},methods:{ykikui(){this.jtuj6juj=0,this.lastTimeShow=0,this.rtjjtj=[],this.tujyjmyu=[];for(let a=0;a<this.rtrtyry.length;a++)this.rtrtyry[a].htytjjy=0,this.rtrtyry[a].yujtj=0,this.rtrtyry[a].dis=!1,this.rtrtyry[a].round=1,this.tujyjmyu.push(this.rtrtyry[a].id);this.trrt="main"},hdg(){this.fghfyh=setInterval(()=>{this.jtuj6juj=Math.round(1e3*(this.jtuj6juj+.015))/1e3,1===this.rtrtyry[this.currentUserId].round?this.rtrtyry[this.currentUserId].htytjjy=this.jtuj6juj:this.rtrtyry[this.currentUserId].yujtj=this.jtuj6juj},15)},hfjgj(){clearInterval(this.fghfyh),this.tyujjgj()},rtukkuyk(){this.fghfyh&&clearInterval(this.fghfyh);1===this.rtrtyry[this.currentUserId].round?this.rtrtyry[this.currentUserId].htytjjy=0:this.rtrtyry[this.currentUserId].yujtj=0;let a=this.rtrtyry[this.currentUserId].id;this.tujyjmyu.splice(0,1),this.tujyjmyu.push(a),this.jtuj6juj=0},disq(){this.fghfyh&&clearInterval(this.fghfyh);1===this.rtrtyry[this.currentUserId].round?this.rtrtyry[this.currentUserId].htytjjy=-1:this.rtrtyry[this.currentUserId].yujtj=-1,this.rtrtyry[this.currentUserId].dis=!0,this.tyujjgj()},tyujjgj(){this.jtuj6juj=0,1===this.rtrtyry[this.currentUserId].round&&2==this.hdhhh&&(this.tujyjmyu.push(this.rtrtyry[this.currentUserId].id),this.rtrtyry[this.currentUserId].round=2),this.tujyjmyu.splice(0,1),this.tujyjmyu.length||(this.yuyimiu(),this.trrt="rez"),this.saveUsersAndQueue()},gfhh(){let a=0;this.rtrtyry.length&&(a=Math.max(...this.rtrtyry.map(a=>a.id))),this.rtyjtrj.id=a+1,this.rtrtyry.push({...this.rtyjtrj}),this.tujyjmyu.push(this.rtyjtrj.id),this.trrt="main",this.rtyjtrj.name="",this.rtyjtrj.num="",this.saveUsersAndQueue()},jyjgjy(a){this.userToDeleteId=a,$(".modal").modal("open")},gyjyuky(){let a=this.rtrtyry.findIndex(a=>a.id===this.userToDeleteId);this.rtrtyry.splice(a,1);let b=this.tujyjmyu.findIndex(a=>a===this.userToDeleteId);this.tujyjmyu.splice(b,1),this.userToDeleteId=null},yuyimiu(){let a=[];for(let b,c=0;c<this.rtrtyry.length;c++)b=0,-1===this.rtrtyry[c].htytjjy&&(b+=1e8),-1===this.rtrtyry[c].yujtj&&(b+=1e8),0===this.rtrtyry[c].htytjjy&&(b+=1e7),0===this.rtrtyry[c].yujtj&&(b+=1e7),b+=0<this.rtrtyry[c].htytjjy&&0<this.rtrtyry[c].yujtj?"sum"===this.wrtye?this.rtrtyry[c].htytjjy+this.rtrtyry[c].yujtj:(this.rtrtyry[c].htytjjy+this.rtrtyry[c].yujtj)/2:this.rtrtyry[c].htytjjy,a.push({id:c,rez:b});a.sort((c,a)=>c.rez-a.rez),this.rtjjtj=[];for(let b=0;b<a.length;b++)this.rtjjtj.push(a[b].id)},fbfvhn(){!0===this.fjfyjyjy.Digit0&&(!0===this.fjfyjyjy.Digit1?this.hdg():!0===this.fjfyjyjy.Digit8&&this.hfjgj())},rgnn(){this.hdhhh=localStorage.getItem("hdhhh"),this.wrtye=localStorage.getItem("wrtye"),this.hdhhh||(this.hdhhh=1),this.wrtye||(this.wrtye="sum");let a=localStorage.getItem("rtrtyry"),b=localStorage.getItem("tujyjmyu");a&&(this.rtrtyry=JSON.parse(a)),b&&(this.tujyjmyu=JSON.parse(b))},sdwsrfg(){localStorage.setItem("hdhhh",this.hdhhh),localStorage.setItem("wrtye",this.wrtye)},saveUsersAndQueue(){let a=JSON.stringify(this.rtrtyry),b=JSON.stringify(this.tujyjmyu);localStorage.setItem("rtrtyry",a),localStorage.setItem("tujyjmyu",b)},resetAll(){localStorage.removeItem("rtrtyry"),localStorage.removeItem("tujyjmyu"),localStorage.removeItem("hdhhh"),localStorage.removeItem("wrtye"),this.jtuj6juj=0,this.lastTimeShow=0,this.rtrtyry=[{id:1,num:"1",name:"\u0418\u0432\u0430\u043D\u043E\u0432 \u0418.\u0418.",htytjjy:0,yujtj:0,dis:!1,round:1},{id:2,num:"2",name:"\u041F\u0435\u0442\u0440\u043E\u0432 \u041F.\u041F.",htytjjy:0,yujtj:0,dis:!1,round:1},{id:3,num:"3",name:"\u0421\u0438\u0434\u043E\u0440\u043E\u0432 \u0421.\u0421.",htytjjy:0,yujtj:0,dis:!1,round:1}],this.tujyjmyu=[1,2,3],this.rtjjtj=[],this.rtyjtrj={id:null,name:"",num:"",htytjjy:0,yujtj:0,dis:!1,round:1},this.userToDeleteId=null,this.hdhhh=1,this.wrtye="sum",this.trrt="main",this.fghfyh=null,this.trrtWidth=null,this.yiubg=!1,this.fjfyjyjy={Digit0:!1,Digit1:!1,Digit8:!1},document.location.reload()}},created(){this.rgnn(),this.trrtWidth=window.innerWidth,window.addEventListener("keydown",a=>{this.fjfyjyjy[a.code]=!0,this.fbfvhn()},!0),window.addEventListener("keyup",a=>{this.fjfyjyjy[a.code]=!1},!0)}};Vue.createApp(App).mount("#app");</script> </body></html>
